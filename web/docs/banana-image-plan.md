# é¦™è•‰ç”Ÿå›¾ï¼ˆBanana Imageï¼‰é¡µé¢å¼€å‘è§„åˆ’æ–‡æ¡£

> ç‰ˆæœ¬: 1.0
> æ—¥æœŸ: 2026-02-05
> çŠ¶æ€: è§„åˆ’ä¸­

---

## ä¸€ã€é¡¹ç›®æ¦‚è¿°

### 1.1 èƒŒæ™¯

åŸºäº New-API ç³»ç»Ÿç°æœ‰çš„å›¾åƒç”Ÿæˆèƒ½åŠ›ï¼Œå¼€å‘ä¸€ä¸ªç»Ÿä¸€çš„å›¾åƒç”Ÿæˆå‰ç«¯ç•Œé¢â€”â€”"é¦™è•‰ç”Ÿå›¾"ã€‚è¯¥é¡µé¢å°†æ•´åˆç³»ç»Ÿæ”¯æŒçš„å¤šç§å›¾åƒç”Ÿæˆæ¨¡å‹ï¼ˆDALL-Eã€FLUXã€Imagenã€Midjourney ç­‰ï¼‰ï¼Œä¸ºç”¨æˆ·æä¾›ä¾¿æ·çš„ AI ç»˜å›¾ä½“éªŒã€‚

### 1.2 ç›®æ ‡

- æä¾›ç›´è§‚ã€æ˜“ç”¨çš„å›¾åƒç”Ÿæˆç•Œé¢
- æ”¯æŒå¤šç§å›¾åƒç”Ÿæˆæ¨¡å‹çš„åˆ‡æ¢
- æä¾›ä¸°å¯Œçš„å‚æ•°é…ç½®é€‰é¡¹
- ä¿å­˜ç”¨æˆ·çš„ç”Ÿæˆå†å²è®°å½•
- æ”¯æŒæç¤ºè¯ä¼˜åŒ–å¢å¼ºåŠŸèƒ½

### 1.3 æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯é€‰å‹ |
|------|----------|
| å‰ç«¯æ¡†æ¶ | React 18 |
| UI ç»„ä»¶åº“ | Semi Design (@douyinfe/semi-ui) |
| æ ·å¼æ–¹æ¡ˆ | Tailwind CSS |
| çŠ¶æ€ç®¡ç† | React Context + useReducer |
| å›¾æ ‡åº“ | lucide-react |
| HTTP è¯·æ±‚ | axios (å¤ç”¨ç°æœ‰å°è£…) |

---

## äºŒã€ç³»ç»Ÿæ¶æ„

### 2.1 é¡µé¢è·¯ç”±

```
/console/banana-image    # é¦™è•‰ç”Ÿå›¾ä¸»é¡µé¢
```

### 2.2 ç›®å½•ç»“æ„

```
src/
â”œâ”€â”€ pages/
â”‚   â””â”€â”€ BananaImage/
â”‚       â””â”€â”€ index.jsx                    # é¡µé¢å…¥å£ï¼ˆè·¯ç”±ç»„ä»¶ï¼‰
â”‚
â”œâ”€â”€ components/
â”‚   â””â”€â”€ banana-image/
â”‚       â”œâ”€â”€ BananaImagePage.jsx          # ä¸»é¡µé¢å¸ƒå±€ç»„ä»¶
â”‚       â”œâ”€â”€ PromptSection/
â”‚       â”‚   â”œâ”€â”€ index.jsx                # æç¤ºè¯åŒºåŸŸå®¹å™¨
â”‚       â”‚   â”œâ”€â”€ PromptInput.jsx          # æ­£å‘æç¤ºè¯è¾“å…¥
â”‚       â”‚   â”œâ”€â”€ NegativePromptInput.jsx  # åå‘æç¤ºè¯è¾“å…¥
â”‚       â”‚   â””â”€â”€ PromptEnhancer.jsx       # æç¤ºè¯å¢å¼ºæŒ‰é’®
â”‚       â”œâ”€â”€ ModelSection/
â”‚       â”‚   â”œâ”€â”€ index.jsx                # æ¨¡å‹é€‰æ‹©åŒºåŸŸå®¹å™¨
â”‚       â”‚   â”œâ”€â”€ ModelSelector.jsx        # æ¨¡å‹ä¸‹æ‹‰é€‰æ‹©å™¨
â”‚       â”‚   â””â”€â”€ ModelInfo.jsx            # æ¨¡å‹ä¿¡æ¯å±•ç¤º
â”‚       â”œâ”€â”€ ParamsSection/
â”‚       â”‚   â”œâ”€â”€ index.jsx                # å‚æ•°é…ç½®åŒºåŸŸå®¹å™¨
â”‚       â”‚   â”œâ”€â”€ ResolutionSelector.jsx   # åˆ†è¾¨ç‡é€‰æ‹© (1K/2K/4K)
â”‚       â”‚   â”œâ”€â”€ AspectRatioSelector.jsx  # å›¾åƒæ¯”ä¾‹é€‰æ‹©
â”‚       â”‚   â”œâ”€â”€ SizeDisplay.jsx          # å°ºå¯¸æ˜¾ç¤º
â”‚       â”‚   â”œâ”€â”€ AdvancedParams.jsx       # é«˜çº§å‚æ•°é…ç½®
â”‚       â”‚   â””â”€â”€ SeedInput.jsx            # éšæœºç§å­è¾“å…¥
â”‚       â”œâ”€â”€ GenerateSection/
â”‚       â”‚   â”œâ”€â”€ index.jsx                # ç”Ÿæˆæ“ä½œåŒºåŸŸ
â”‚       â”‚   â”œâ”€â”€ GenerateButton.jsx       # ç”ŸæˆæŒ‰é’®
â”‚       â”‚   â”œâ”€â”€ CostEstimate.jsx         # è´¹ç”¨é¢„ä¼°æ˜¾ç¤º
â”‚       â”‚   â””â”€â”€ ProgressIndicator.jsx    # ç”Ÿæˆè¿›åº¦æŒ‡ç¤º
â”‚       â”œâ”€â”€ ResultSection/
â”‚       â”‚   â”œâ”€â”€ index.jsx                # ç»“æœå±•ç¤ºåŒºåŸŸ
â”‚       â”‚   â”œâ”€â”€ ImagePreview.jsx         # å›¾åƒé¢„è§ˆç»„ä»¶
â”‚       â”‚   â”œâ”€â”€ ImageActions.jsx         # å›¾åƒæ“ä½œæŒ‰é’®ç»„
â”‚       â”‚   â””â”€â”€ ImageGallery.jsx         # å¤šå›¾å±•ç¤ºç”»å»Š
â”‚       â””â”€â”€ HistorySidebar/
â”‚           â”œâ”€â”€ index.jsx                # å†å²è®°å½•ä¾§è¾¹æ 
â”‚           â”œâ”€â”€ HistoryList.jsx          # å†å²åˆ—è¡¨ç»„ä»¶
â”‚           â””â”€â”€ HistoryItem.jsx          # å†å²è®°å½•é¡¹
â”‚
â”œâ”€â”€ hooks/
â”‚   â””â”€â”€ banana-image/
â”‚       â”œâ”€â”€ useBananaImage.js            # ä¸»ä¸šåŠ¡é€»è¾‘ Hook
â”‚       â”œâ”€â”€ useImageGeneration.js        # å›¾åƒç”Ÿæˆ API è°ƒç”¨
â”‚       â”œâ”€â”€ useModelList.js              # æ¨¡å‹åˆ—è¡¨ç®¡ç†
â”‚       â”œâ”€â”€ useHistoryStorage.js         # å†å²è®°å½•å­˜å‚¨
â”‚       â”œâ”€â”€ usePromptEnhancer.js         # æç¤ºè¯å¢å¼º
â”‚       â””â”€â”€ useParamsConfig.js           # å‚æ•°é…ç½®ç®¡ç†
â”‚
â”œâ”€â”€ contexts/
â”‚   â””â”€â”€ BananaImageContext/
â”‚       â”œâ”€â”€ index.jsx                    # Context Provider
â”‚       â”œâ”€â”€ reducer.js                   # çŠ¶æ€ Reducer
â”‚       â””â”€â”€ actions.js                   # Action å®šä¹‰
â”‚
â””â”€â”€ constants/
    â””â”€â”€ banana-image.constants.js        # å¸¸é‡å®šä¹‰
```

### 2.3 æ•°æ®æµæ¶æ„

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BananaImageContext                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”‚
â”‚  â”‚  State:                                              â”‚    â”‚
â”‚  â”‚  - prompt / negativePrompt                           â”‚    â”‚
â”‚  â”‚  - selectedModel                                     â”‚    â”‚
â”‚  â”‚  - params (size, n, seed, guidance, steps)          â”‚    â”‚
â”‚  â”‚  - generationStatus (idle/loading/success/error)    â”‚    â”‚
â”‚  â”‚  - generatedImages []                               â”‚    â”‚
â”‚  â”‚  - history []                                        â”‚    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      Components                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚ Prompt   â”‚ â”‚ Model    â”‚ â”‚ Params   â”‚ â”‚ Result   â”‚       â”‚
â”‚  â”‚ Section  â”‚ â”‚ Section  â”‚ â”‚ Section  â”‚ â”‚ Section  â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                              â”‚
                              â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                        Hooks                                 â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚  â”‚ useImageGeneration â”‚  â”‚ useHistoryStorage  â”‚            â”‚
â”‚  â”‚ POST /v1/images/   â”‚  â”‚ localStorage       â”‚            â”‚
â”‚  â”‚ generations        â”‚  â”‚                    â”‚            â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ä¸‰ã€åŠŸèƒ½æ¨¡å—è¯¦ç»†è®¾è®¡

### 3.1 æç¤ºè¯è¾“å…¥æ¨¡å— (PromptSection)

#### 3.1.1 æ­£å‘æç¤ºè¯ (PromptInput)

| å±æ€§ | è¯´æ˜ |
|------|------|
| ç»„ä»¶ç±»å‹ | TextArea å¤šè¡Œæ–‡æœ¬è¾“å…¥ |
| å ä½æç¤º | "æè¿°ä½ æƒ³è¦ç”Ÿæˆçš„å›¾åƒå†…å®¹..." |
| æœ€å¤§é•¿åº¦ | 4000 å­—ç¬¦ |
| å¿«æ·é”® | Ctrl/Cmd + Enter å¿«é€Ÿç”Ÿæˆ |
| å­—æ•°ç»Ÿè®¡ | å³ä¸‹è§’æ˜¾ç¤ºå½“å‰å­—æ•° |

```jsx
// ç»„ä»¶æ¥å£
<PromptInput
  value={prompt}
  onChange={setPrompt}
  onSubmit={handleGenerate}
  maxLength={4000}
  placeholder="æè¿°ä½ æƒ³è¦ç”Ÿæˆçš„å›¾åƒå†…å®¹..."
/>
```

#### 3.1.2 åå‘æç¤ºè¯ (NegativePromptInput)

| å±æ€§ | è¯´æ˜ |
|------|------|
| ç»„ä»¶ç±»å‹ | TextArea å¤šè¡Œæ–‡æœ¬è¾“å…¥ï¼ˆå¯æŠ˜å ï¼‰ |
| å ä½æç¤º | "æè¿°ä½ ä¸æƒ³åœ¨å›¾åƒä¸­å‡ºç°çš„å…ƒç´ ..." |
| é»˜è®¤çŠ¶æ€ | æŠ˜å éšè— |
| é€‚ç”¨æ¨¡å‹ | FLUXã€Stable Diffusionï¼ˆDALL-E ä¸æ”¯æŒï¼‰ |

```jsx
// ç»„ä»¶æ¥å£
<NegativePromptInput
  value={negativePrompt}
  onChange={setNegativePrompt}
  disabled={!modelSupportsNegative}
  collapsed={isCollapsed}
  onToggle={toggleCollapse}
/>
```

#### 3.1.3 æç¤ºè¯å¢å¼º (PromptEnhancer)

| å±æ€§ | è¯´æ˜ |
|------|------|
| åŠŸèƒ½ | è°ƒç”¨ LLM ä¼˜åŒ–ç”¨æˆ·çš„æç¤ºè¯ |
| è§¦å‘æ–¹å¼ | ç‚¹å‡»"å¢å¼º"æŒ‰é’® |
| è°ƒç”¨ API | POST /v1/chat/completions |
| ä½¿ç”¨æ¨¡å‹ | gpt-4o-mini æˆ–å…¶ä»–è½»é‡æ¨¡å‹ |

**å¢å¼ºé€»è¾‘æµç¨‹ï¼š**
```
ç”¨æˆ·æç¤ºè¯ â†’ LLM ä¼˜åŒ– â†’ è¿”å›å¢å¼ºåçš„æç¤ºè¯ â†’ ç”¨æˆ·ç¡®è®¤ä½¿ç”¨
```

**LLM Prompt æ¨¡æ¿ï¼š**
```
ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ AI ç»˜å›¾æç¤ºè¯ä¼˜åŒ–ä¸“å®¶ã€‚è¯·å°†ç”¨æˆ·çš„ç®€å•æè¿°ä¼˜åŒ–ä¸ºè¯¦ç»†ã€
ä¸“ä¸šçš„å›¾åƒç”Ÿæˆæç¤ºè¯ï¼ŒåŒ…å«ä»¥ä¸‹è¦ç´ ï¼š
- ä¸»ä½“æè¿°ï¼ˆsubjectï¼‰
- é£æ ¼æè¿°ï¼ˆstyleï¼‰
- å…‰çº¿æè¿°ï¼ˆlightingï¼‰
- æ„å›¾æè¿°ï¼ˆcompositionï¼‰
- ç”»è´¨æè¿°ï¼ˆqualityï¼‰

ç”¨æˆ·è¾“å…¥: {user_prompt}

è¯·ç›´æ¥è¾“å‡ºä¼˜åŒ–åçš„è‹±æ–‡æç¤ºè¯ï¼Œä¸éœ€è¦è§£é‡Šã€‚
```

---

### 3.2 æ¨¡å‹é€‰æ‹©æ¨¡å— (ModelSection)

#### 3.2.1 æ¨¡å‹è·å–æ–¹å¼

**æ•°æ®æ¥æºï¼š** é€šè¿‡ API `/v1/models` è·å–ç”¨æˆ·ä»¤ç‰Œï¼ˆTokenï¼‰å¯ç”¨çš„æ¨¡å‹åˆ—è¡¨ï¼Œå‰ç«¯è¿‡æ»¤å‡ºå›¾åƒç”Ÿæˆæ¨¡å‹ã€‚

**è¿‡æ»¤é€»è¾‘ï¼š**
```javascript
// å›¾åƒç”Ÿæˆæ¨¡å‹å‰ç¼€åˆ—è¡¨
const IMAGE_MODEL_PREFIXES = [
  'dall-e',
  'gpt-image',
  'flux',
  'imagen',
  'stable-diffusion',
  'midjourney',
  'sd-',
  'sdxl-'
];

// ä» /v1/models è¿”å›çš„æ¨¡å‹åˆ—è¡¨ä¸­è¿‡æ»¤å›¾åƒç”Ÿæˆæ¨¡å‹
const filterImageModels = (models) => {
  return models.filter(model =>
    IMAGE_MODEL_PREFIXES.some(prefix =>
      model.id.toLowerCase().includes(prefix)
    )
  );
};
```

#### 3.2.2 å¸¸è§å›¾åƒç”Ÿæˆæ¨¡å‹å‚è€ƒ

> æ³¨æ„ï¼šå®é™…å¯ç”¨æ¨¡å‹å–å†³äºç”¨æˆ·ä»¤ç‰Œé…ç½®çš„æ¸ é“å’Œæ¨¡å‹æƒé™

| æ¨¡å‹ ID | æ˜¾ç¤ºåç§° | æä¾›å•† | ç‰¹ç‚¹ |
|---------|----------|--------|------|
| `dall-e-3` | DALL-E 3 | OpenAI | é«˜è´¨é‡ã€ç†è§£åŠ›å¼ºã€è‡ªåŠ¨ä¼˜åŒ–æç¤ºè¯ |
| `dall-e-2` | DALL-E 2 | OpenAI | é€Ÿåº¦å¿«ã€æˆæœ¬ä½ |
| `gpt-image-1` | GPT Image | OpenAI | æœ€æ–°æ¨¡å‹ |
| `flux-1.1-pro` | FLUX 1.1 Pro | Replicate | é«˜è´¨é‡ã€æ”¯æŒè´Ÿå‘æç¤ºè¯ |
| `flux.1-schnell` | FLUX Schnell | SiliconFlow | é€Ÿåº¦æå¿« |
| `flux.1-dev` | FLUX Dev | SiliconFlow | å¼€å‘ç‰ˆæœ¬ |
| `imagen-3.0-generate-002` | Imagen 3.0 | Google | Google æœ€æ–°æ¨¡å‹ |
| `stable-diffusion-xl` | SDXL | Various | å¼€æºé«˜è´¨é‡æ¨¡å‹ |

#### 3.2.3 æ¨¡å‹é€‰æ‹©å™¨ (ModelSelector)

```jsx
// ç»„ä»¶æ¥å£
<ModelSelector
  models={availableModels}
  value={selectedModel}
  onChange={setSelectedModel}
  loading={isLoadingModels}
/>
```

**UI è®¾è®¡ï¼š**
- ä¸‹æ‹‰é€‰æ‹©æ¡†å½¢å¼
- æ˜¾ç¤ºæ¨¡å‹å›¾æ ‡ + åç§°
- åˆ†ç»„æ˜¾ç¤ºï¼ˆæŒ‰æä¾›å•†åˆ†ç»„ï¼‰
- æ”¯æŒæœç´¢è¿‡æ»¤

#### 3.2.3 æ¨¡å‹ä¿¡æ¯å¡ç‰‡ (ModelInfo)

```jsx
// ç»„ä»¶æ¥å£
<ModelInfo
  model={selectedModel}
  features={modelFeatures}
/>
```

**æ˜¾ç¤ºå†…å®¹ï¼š**
- æ¨¡å‹æè¿°
- æ”¯æŒçš„åŠŸèƒ½æ ‡ç­¾ï¼ˆå¦‚ï¼šæ”¯æŒè´Ÿå‘æç¤ºè¯ã€æ”¯æŒç§å­ç­‰ï¼‰
- æ¨èå°ºå¯¸
- é¢„ä¼°ç”Ÿæˆæ—¶é—´

---

### 3.3 å‚æ•°é…ç½®æ¨¡å— (ParamsSection)

#### 3.3.1 åˆ†è¾¨ç‡é€‰æ‹©å™¨ (ResolutionSelector)

**åˆ†è¾¨ç‡æ¡£ä½é…ç½®ï¼š**

| æ¡£ä½ | åŸºå‡†åƒç´  | è¯´æ˜ | é€‚ç”¨åœºæ™¯ |
|------|----------|------|----------|
| **1K** | 1024px | æ ‡å‡†è´¨é‡ | æ—¥å¸¸ä½¿ç”¨ã€ç¤¾äº¤åˆ†äº« |
| **2K** | 2048px | é«˜è´¨é‡ | æ‰“å°è¾“å‡ºã€é«˜æ¸…å±•ç¤º |
| **4K** | 4096px | è¶…é«˜è´¨é‡ | å¤§å°ºå¯¸æ‰“å°ã€ä¸“ä¸šç”¨é€” |

**å¸¸é‡å®šä¹‰ï¼š**
```javascript
// constants/banana-image.constants.js

export const RESOLUTION_OPTIONS = [
  {
    key: '1k',
    label: '1K',
    baseSize: 1024,
    description: 'æ ‡å‡†è´¨é‡ï¼Œé€‚åˆæ—¥å¸¸ä½¿ç”¨'
  },
  {
    key: '2k',
    label: '2K',
    baseSize: 2048,
    description: 'é«˜è´¨é‡ï¼Œé€‚åˆæ‰“å°è¾“å‡º'
  },
  {
    key: '4k',
    label: '4K',
    baseSize: 4096,
    description: 'è¶…é«˜è´¨é‡ï¼Œé€‚åˆä¸“ä¸šç”¨é€”'
  }
];
```

**ç»„ä»¶æ¥å£ï¼š**
```jsx
<ResolutionSelector
  value={resolution}           // '1k' | '2k' | '4k'
  onChange={setResolution}
  disabled={false}
/>
```

**UI è®¾è®¡ï¼š** ä½¿ç”¨ Radio æŒ‰é’®ç»„æˆ– Tabs
```
â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”
â”‚  1K  â”‚  â”‚  2K  â”‚  â”‚  4K  â”‚
â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜
```

---

#### 3.3.2 å›¾åƒæ¯”ä¾‹é€‰æ‹©å™¨ (AspectRatioSelector)

**æ¯”ä¾‹é…ç½®é€‰é¡¹ï¼š**

| æ¯”ä¾‹ | åç§° | 1K å°ºå¯¸ | 2K å°ºå¯¸ | 4K å°ºå¯¸ | é€‚ç”¨åœºæ™¯ |
|------|------|---------|---------|---------|----------|
| **1:1** | æ­£æ–¹å½¢ | 1024Ã—1024 | 2048Ã—2048 | 4096Ã—4096 | å¤´åƒã€å›¾æ ‡ã€ç¤¾äº¤åª’ä½“ |
| **16:9** | æ¨ªå±å®½å¹… | 1820Ã—1024 | 3640Ã—2048 | 7280Ã—4096 | è§†é¢‘å°é¢ã€æ¡Œé¢å£çº¸ã€Banner |
| **9:16** | ç«–å± | 1024Ã—1820 | 2048Ã—3640 | 4096Ã—7280 | æ‰‹æœºå£çº¸ã€çŸ­è§†é¢‘å°é¢ã€æµ·æŠ¥ |
| **4:3** | æ¨ªå±æ ‡å‡† | 1365Ã—1024 | 2730Ã—2048 | 5460Ã—4096 | ä¼ ç»Ÿæ˜¾ç¤ºå™¨ã€PPTã€æ–‡æ¡£é…å›¾ |
| **3:4** | ç«–å±æ ‡å‡† | 1024Ã—1365 | 2048Ã—2730 | 4096Ã—5460 | ç«–ç‰ˆæµ·æŠ¥ã€äº§å“å›¾ |
| **3:2** | æ¨ªå±ç…§ç‰‡ | 1536Ã—1024 | 3072Ã—2048 | 6144Ã—4096 | ç›¸æœºç…§ç‰‡æ¯”ä¾‹ã€æ‘„å½±ä½œå“ |
| **2:3** | ç«–å±ç…§ç‰‡ | 1024Ã—1536 | 2048Ã—3072 | 4096Ã—6144 | ç«–ç‰ˆç…§ç‰‡ã€äººåƒæ‘„å½± |
| **21:9** | è¶…å®½å± | 2389Ã—1024 | 4778Ã—2048 | 9556Ã—4096 | ç”µå½±ç”»å¹…ã€å¸¦é±¼å±å£çº¸ |

**å¸¸é‡å®šä¹‰ï¼š**
```javascript
// constants/banana-image.constants.js

export const ASPECT_RATIO_OPTIONS = [
  {
    key: '1:1',
    label: '1:1',
    name: 'æ­£æ–¹å½¢',
    width: 1,
    height: 1,
    icon: 'Square',
    description: 'å¤´åƒã€å›¾æ ‡ã€ç¤¾äº¤åª’ä½“'
  },
  {
    key: '16:9',
    label: '16:9',
    name: 'æ¨ªå±å®½å¹…',
    width: 16,
    height: 9,
    icon: 'RectangleHorizontal',
    description: 'è§†é¢‘å°é¢ã€æ¡Œé¢å£çº¸'
  },
  {
    key: '9:16',
    label: '9:16',
    name: 'ç«–å±',
    width: 9,
    height: 16,
    icon: 'RectangleVertical',
    description: 'æ‰‹æœºå£çº¸ã€çŸ­è§†é¢‘å°é¢'
  },
  {
    key: '4:3',
    label: '4:3',
    name: 'æ¨ªå±æ ‡å‡†',
    width: 4,
    height: 3,
    icon: 'RectangleHorizontal',
    description: 'ä¼ ç»Ÿæ˜¾ç¤ºå™¨ã€PPT'
  },
  {
    key: '3:4',
    label: '3:4',
    name: 'ç«–å±æ ‡å‡†',
    width: 3,
    height: 4,
    icon: 'RectangleVertical',
    description: 'ç«–ç‰ˆæµ·æŠ¥ã€äº§å“å›¾'
  },
  {
    key: '3:2',
    label: '3:2',
    name: 'æ¨ªå±ç…§ç‰‡',
    width: 3,
    height: 2,
    icon: 'RectangleHorizontal',
    description: 'ç›¸æœºç…§ç‰‡æ¯”ä¾‹'
  },
  {
    key: '2:3',
    label: '2:3',
    name: 'ç«–å±ç…§ç‰‡',
    width: 2,
    height: 3,
    icon: 'RectangleVertical',
    description: 'ç«–ç‰ˆç…§ç‰‡ã€äººåƒ'
  },
  {
    key: '21:9',
    label: '21:9',
    name: 'è¶…å®½å±',
    width: 21,
    height: 9,
    icon: 'RectangleHorizontal',
    description: 'ç”µå½±ç”»å¹…ã€å¸¦é±¼å±'
  }
];
```

**å°ºå¯¸è®¡ç®—å‡½æ•°ï¼š**
```javascript
/**
 * æ ¹æ®åˆ†è¾¨ç‡å’Œæ¯”ä¾‹è®¡ç®—å®é™…å›¾åƒå°ºå¯¸
 * @param {string} resolution - åˆ†è¾¨ç‡æ¡£ä½ ('1k' | '2k' | '4k')
 * @param {string} aspectRatio - å›¾åƒæ¯”ä¾‹ ('1:1' | '16:9' | ...)
 * @returns {{ width: number, height: number }}
 */
export const calculateImageSize = (resolution, aspectRatio) => {
  const resolutionConfig = RESOLUTION_OPTIONS.find(r => r.key === resolution);
  const ratioConfig = ASPECT_RATIO_OPTIONS.find(r => r.key === aspectRatio);

  if (!resolutionConfig || !ratioConfig) {
    return { width: 1024, height: 1024 };
  }

  const baseSize = resolutionConfig.baseSize;
  const { width: ratioW, height: ratioH } = ratioConfig;

  // ä»¥çŸ­è¾¹ä¸ºåŸºå‡†è®¡ç®—ï¼Œç¡®ä¿çŸ­è¾¹ç­‰äº baseSize
  if (ratioW >= ratioH) {
    // æ¨ªå‘æˆ–æ­£æ–¹å½¢ï¼šé«˜åº¦ä¸ºåŸºå‡†
    const height = baseSize;
    const width = Math.round((baseSize * ratioW) / ratioH);
    return { width, height };
  } else {
    // çºµå‘ï¼šå®½åº¦ä¸ºåŸºå‡†
    const width = baseSize;
    const height = Math.round((baseSize * ratioH) / ratioW);
    return { width, height };
  }
};

// ä½¿ç”¨ç¤ºä¾‹
calculateImageSize('1k', '16:9');  // { width: 1820, height: 1024 }
calculateImageSize('2k', '1:1');   // { width: 2048, height: 2048 }
calculateImageSize('1k', '9:16');  // { width: 1024, height: 1820 }
```

**ç»„ä»¶æ¥å£ï¼š**
```jsx
<AspectRatioSelector
  value={aspectRatio}           // '1:1' | '16:9' | '9:16' | ...
  onChange={setAspectRatio}
  showPreview={true}            // æ˜¾ç¤ºæ¯”ä¾‹é¢„è§ˆå›¾
/>
```

**UI è®¾è®¡ï¼š** å¯è§†åŒ–æ¯”ä¾‹é¢„è§ˆå—
```
â”Œâ”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     â”‚  â”‚       â”‚  â”‚   â”‚  â”‚      â”‚  â”‚    â”‚  â”‚      â”‚  â”‚    â”‚  â”‚         â”‚
â”‚ 1:1 â”‚  â”‚ 16:9  â”‚  â”‚9: â”‚  â”‚ 4:3  â”‚  â”‚3:4 â”‚  â”‚ 3:2  â”‚  â”‚2:3 â”‚  â”‚  21:9   â”‚
â”‚     â”‚  â”‚       â”‚  â”‚16 â”‚  â”‚      â”‚  â”‚    â”‚  â”‚      â”‚  â”‚    â”‚  â”‚         â”‚
â””â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
  âœ“
```

---

#### 3.3.3 å°ºå¯¸æ˜¾ç¤º (SizeDisplay)

> å°ºå¯¸ç”±åˆ†è¾¨ç‡ + æ¯”ä¾‹è‡ªåŠ¨è®¡ç®—å¾—å‡ºï¼Œä»…ä½œå±•ç¤ºç”¨é€”

```jsx
<SizeDisplay
  resolution={resolution}
  aspectRatio={aspectRatio}
/>
```

**æ˜¾ç¤ºå†…å®¹ï¼š**
```
å½“å‰å°ºå¯¸: 1820 Ã— 1024 åƒç´ 
```

#### 3.3.4 é«˜çº§å‚æ•° (AdvancedParams)

| å‚æ•° | ç±»å‹ | èŒƒå›´ | é»˜è®¤å€¼ | è¯´æ˜ |
|------|------|------|--------|------|
| ç”Ÿæˆæ•°é‡ (n) | Number | 1-4 | 1 | ä¸€æ¬¡ç”Ÿæˆçš„å›¾ç‰‡æ•°é‡ |
| å¼•å¯¼ç³»æ•° (guidance_scale) | Slider | 1-20 | 7.5 | æç¤ºè¯å½±å“å¼ºåº¦ |
| æ¨ç†æ­¥æ•° (num_inference_steps) | Slider | 10-150 | 50 | ç”Ÿæˆè´¨é‡/é€Ÿåº¦å¹³è¡¡ |
| éšæœºç§å­ (seed) | Number | -1 ~ 2^32 | -1 | -1 è¡¨ç¤ºéšæœº |

```jsx
// ç»„ä»¶æ¥å£
<AdvancedParams
  params={advancedParams}
  onChange={setAdvancedParams}
  modelCapabilities={currentModelCapabilities}
/>
```

**æ³¨æ„ï¼š** ä¸åŒæ¨¡å‹æ”¯æŒçš„å‚æ•°ä¸åŒï¼Œéœ€è¦æ ¹æ®é€‰ä¸­æ¨¡å‹åŠ¨æ€æ˜¾ç¤º/éšè—å‚æ•°é¡¹ã€‚

#### 3.3.5 æ¨¡å‹å‚æ•°èƒ½åŠ›çŸ©é˜µ

| æ¨¡å‹ | n | guidance | steps | seed | negative |
|------|---|----------|-------|------|----------|
| DALL-E 3 | âœ… 1 | âŒ | âŒ | âŒ | âŒ |
| DALL-E 2 | âœ… 1-4 | âŒ | âŒ | âŒ | âŒ |
| FLUX 1.1 Pro | âœ… 1-4 | âœ… | âœ… | âœ… | âœ… |
| FLUX Schnell | âœ… 1-4 | âœ… | âœ… | âœ… | âœ… |
| Imagen 3.0 | âœ… 1-4 | âŒ | âŒ | âŒ | âŒ |

---

### 3.4 ç”Ÿæˆæ“ä½œæ¨¡å— (GenerateSection)

#### 3.4.1 ç”ŸæˆæŒ‰é’® (GenerateButton)

```jsx
// ç»„ä»¶æ¥å£
<GenerateButton
  onClick={handleGenerate}
  loading={isGenerating}
  disabled={!canGenerate}
  shortcut="Ctrl+Enter"
/>
```

**çŠ¶æ€è®¾è®¡ï¼š**
| çŠ¶æ€ | æ˜¾ç¤º | è¯´æ˜ |
|------|------|------|
| idle | "ç”Ÿæˆå›¾åƒ" | é»˜è®¤çŠ¶æ€ï¼Œå¯ç‚¹å‡» |
| loading | "ç”Ÿæˆä¸­..." + Spinner | è¯·æ±‚ä¸­ï¼Œä¸å¯ç‚¹å‡» |
| disabled | "ç”Ÿæˆå›¾åƒ"ï¼ˆç°è‰²ï¼‰ | å‚æ•°ä¸å®Œæ•´æˆ–ä½™é¢ä¸è¶³ |

#### 3.4.2 è´¹ç”¨é¢„ä¼° (CostEstimate)

```jsx
// ç»„ä»¶æ¥å£
<CostEstimate
  model={selectedModel}
  params={currentParams}
  userBalance={userBalance}
/>
```

**æ˜¾ç¤ºå†…å®¹ï¼š**
- é¢„è®¡æ¶ˆè€—ï¼šX ç§¯åˆ†/ç¾å…ƒ
- å½“å‰ä½™é¢ï¼šY ç§¯åˆ†/ç¾å…ƒ
- ä½™é¢ä¸è¶³æ—¶æ˜¾ç¤ºè­¦å‘Š

#### 3.4.3 ç”Ÿæˆè¿›åº¦ (ProgressIndicator)

```jsx
// ç»„ä»¶æ¥å£
<ProgressIndicator
  status={generationStatus}
  progress={progressPercent}
  message={statusMessage}
  onCancel={handleCancel}
/>
```

**çŠ¶æ€æµè½¬ï¼š**
```
idle â†’ submitting â†’ processing â†’ completed/failed
         â”‚              â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â†’ cancelled
```

---

### 3.5 ç»“æœå±•ç¤ºæ¨¡å— (ResultSection)

#### 3.5.1 å›¾åƒé¢„è§ˆ (ImagePreview)

```jsx
// ç»„ä»¶æ¥å£
<ImagePreview
  image={currentImage}
  loading={isLoading}
  onZoom={handleZoom}
  onError={handleImageError}
/>
```

**åŠŸèƒ½ï¼š**
- å›¾åƒåŠ è½½å ä½ç¬¦
- åŠ è½½å¤±è´¥å…œåº•æ˜¾ç¤º
- ç‚¹å‡»æ”¾å¤§æŸ¥çœ‹
- æ”¯æŒæ‰‹åŠ¿ç¼©æ”¾ï¼ˆç§»åŠ¨ç«¯ï¼‰

#### 3.5.2 å›¾åƒæ“ä½œæŒ‰é’®ç»„ (ImageActions)

| æ“ä½œ | å›¾æ ‡ | å¿«æ·é”® | è¯´æ˜ |
|------|------|--------|------|
| ä¸‹è½½ | Download | Ctrl+S | ä¸‹è½½åŸå›¾åˆ°æœ¬åœ° |
| æ”¾å¤§ | ZoomIn | - | å…¨å±æŸ¥çœ‹å¤§å›¾ |
| å¤åˆ¶æç¤ºè¯ | Copy | Ctrl+C | å¤åˆ¶ç”Ÿæˆæ­¤å›¾çš„æç¤ºè¯ |
| é‡æ–°ç”Ÿæˆ | RefreshCw | Ctrl+R | ä½¿ç”¨ç›¸åŒå‚æ•°é‡æ–°ç”Ÿæˆ |
| ä½¿ç”¨æ­¤å›¾ | Image | - | ä½œä¸ºå‚è€ƒå›¾ï¼ˆå›¾ç”Ÿå›¾ï¼‰ |
| åˆ†äº« | Share | - | ç”Ÿæˆåˆ†äº«é“¾æ¥ |

```jsx
// ç»„ä»¶æ¥å£
<ImageActions
  image={currentImage}
  onDownload={handleDownload}
  onZoom={handleZoom}
  onCopyPrompt={handleCopyPrompt}
  onRegenerate={handleRegenerate}
/>
```

#### 3.5.3 å¤šå›¾ç”»å»Š (ImageGallery)

```jsx
// ç»„ä»¶æ¥å£
<ImageGallery
  images={generatedImages}
  currentIndex={selectedIndex}
  onSelect={setSelectedIndex}
/>
```

**åŠŸèƒ½ï¼š**
- ç¼©ç•¥å›¾ç½‘æ ¼å±•ç¤º
- å½“å‰é€‰ä¸­é«˜äº®
- å·¦å³åˆ‡æ¢ç®­å¤´
- é”®ç›˜æ–¹å‘é”®åˆ‡æ¢

---

### 3.6 å†å²è®°å½•æ¨¡å— (HistorySidebar)

#### 3.6.1 æ•°æ®ç»“æ„

```typescript
interface HistoryRecord {
  id: string;                    // å”¯ä¸€æ ‡è¯† (UUID)
  timestamp: number;             // ç”Ÿæˆæ—¶é—´æˆ³
  prompt: string;                // æ­£å‘æç¤ºè¯
  negativePrompt?: string;       // åå‘æç¤ºè¯
  model: string;                 // ä½¿ç”¨çš„æ¨¡å‹
  params: {                      // ç”Ÿæˆå‚æ•°
    size: string;
    n: number;
    guidance_scale?: number;
    num_inference_steps?: number;
    seed?: number;
  };
  images: {                      // ç”Ÿæˆçš„å›¾åƒ
    url: string;                 // å›¾åƒ URL
    thumbnail?: string;          // ç¼©ç•¥å›¾ URL
  }[];
  status: 'success' | 'failed';  // ç”ŸæˆçŠ¶æ€
  cost?: number;                 // æ¶ˆè€—è´¹ç”¨
}
```

#### 3.6.2 å­˜å‚¨æ–¹æ¡ˆ

**æ–¹æ¡ˆï¼šlocalStorage + IndexedDB æ··åˆå­˜å‚¨**

| æ•°æ®ç±»å‹ | å­˜å‚¨ä½ç½® | è¯´æ˜ |
|----------|----------|------|
| å†å²ç´¢å¼• | localStorage | å¿«é€Ÿè¯»å–åˆ—è¡¨ |
| å›¾åƒæ•°æ® | IndexedDB | å­˜å‚¨ base64 å›¾åƒ |
| å…ƒæ•°æ® | localStorage | æç¤ºè¯ã€å‚æ•°ç­‰ |

**å­˜å‚¨å®¹é‡é™åˆ¶ï¼š**
- æœ€å¤§ä¿å­˜ 100 æ¡å†å²è®°å½•
- è¶…å‡ºåè‡ªåŠ¨åˆ é™¤æœ€æ—§çš„è®°å½•
- æä¾›æ‰‹åŠ¨æ¸…ç©ºåŠŸèƒ½

#### 3.6.3 å†å²åˆ—è¡¨ (HistoryList)

```jsx
// ç»„ä»¶æ¥å£
<HistoryList
  records={historyRecords}
  onSelect={handleSelectRecord}
  onDelete={handleDeleteRecord}
  onClear={handleClearAll}
  loading={isLoading}
/>
```

#### 3.6.4 å†å²è®°å½•é¡¹ (HistoryItem)

```jsx
// ç»„ä»¶æ¥å£
<HistoryItem
  record={record}
  selected={isSelected}
  onClick={handleClick}
  onDelete={handleDelete}
/>
```

**æ˜¾ç¤ºå†…å®¹ï¼š**
- ç¼©ç•¥å›¾é¢„è§ˆ
- æç¤ºè¯æ‘˜è¦ï¼ˆæˆªæ–­æ˜¾ç¤ºï¼‰
- ç”Ÿæˆæ—¶é—´ï¼ˆç›¸å¯¹æ—¶é—´ï¼Œå¦‚"2å°æ—¶å‰"ï¼‰
- æ¨¡å‹æ ‡ç­¾
- åˆ é™¤æŒ‰é’®ï¼ˆhover æ˜¾ç¤ºï¼‰

---

## å››ã€API æ¥å£è®¾è®¡

### 4.1 å¤ç”¨ç°æœ‰æ¥å£

#### 4.1.1 å›¾åƒç”Ÿæˆæ¥å£

**ç«¯ç‚¹ï¼š** `POST /v1/images/generations`

**è¯·æ±‚ä½“ï¼š**
```json
{
  "model": "dall-e-3",
  "prompt": "A cute baby sea otter",
  "negative_prompt": "blurry, low quality",
  "size": "1024x1024",
  "n": 1,
  "response_format": "url",
  "guidance_scale": 7.5,
  "num_inference_steps": 50,
  "seed": 12345
}
```

**å“åº”ä½“ï¼š**
```json
{
  "created": 1707120000,
  "data": [
    {
      "url": "https://...",
      "revised_prompt": "...",
      "b64_json": "..."
    }
  ]
}
```

#### 4.1.2 æç¤ºè¯å¢å¼ºæ¥å£

**ç«¯ç‚¹ï¼š** `POST /v1/chat/completions`

**è¯·æ±‚ä½“ï¼š**
```json
{
  "model": "gpt-4o-mini",
  "messages": [
    {
      "role": "system",
      "content": "ä½ æ˜¯ä¸€ä¸ªä¸“ä¸šçš„ AI ç»˜å›¾æç¤ºè¯ä¼˜åŒ–ä¸“å®¶..."
    },
    {
      "role": "user",
      "content": "è¯·ä¼˜åŒ–è¿™ä¸ªæç¤ºè¯: {user_prompt}"
    }
  ],
  "max_tokens": 500
}
```

#### 4.1.3 æ¨¡å‹åˆ—è¡¨æ¥å£

**ç«¯ç‚¹ï¼š** `GET /v1/models`

**ç­›é€‰å›¾åƒç”Ÿæˆæ¨¡å‹ï¼š**
```javascript
const imageModels = models.filter(m =>
  m.id.includes('dall-e') ||
  m.id.includes('flux') ||
  m.id.includes('imagen')
);
```

### 4.2 å‰ç«¯æœ¬åœ°å­˜å‚¨æ¥å£

```javascript
// å†å²è®°å½•å­˜å‚¨ API
const historyStorage = {
  // è·å–æ‰€æœ‰è®°å½•
  getAll(): HistoryRecord[],

  // è·å–å•æ¡è®°å½•
  getById(id: string): HistoryRecord | null,

  // æ·»åŠ è®°å½•
  add(record: HistoryRecord): void,

  // åˆ é™¤è®°å½•
  delete(id: string): void,

  // æ¸…ç©ºæ‰€æœ‰
  clear(): void,

  // è·å–å­˜å‚¨ä½¿ç”¨é‡
  getUsage(): { used: number, total: number }
};
```

---

## äº”ã€é¡µé¢å¸ƒå±€è®¾è®¡

### 5.1 æ•´ä½“å¸ƒå±€

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                          Header                                  â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                            â”‚                    â”‚
â”‚              ä¸»æ“ä½œåŒºåŸŸ                      â”‚    å†å²è®°å½•ä¾§æ      â”‚
â”‚                                            â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚         æç¤ºè¯è¾“å…¥åŒºåŸŸ                 â”‚  â”‚  â”‚  å†å²åˆ—è¡¨    â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  â”‚     æ­£å‘æç¤ºè¯ TextArea         â”‚  â”‚  â”‚  â”‚  [ç¼©ç•¥å›¾1]   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚  [ç¼©ç•¥å›¾2]   â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚  [ç¼©ç•¥å›¾3]   â”‚  â”‚
â”‚  â”‚  â”‚     åå‘æç¤ºè¯ï¼ˆå¯æŠ˜å ï¼‰         â”‚  â”‚  â”‚  â”‚  [ç¼©ç•¥å›¾4]   â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚     ...      â”‚  â”‚
â”‚  â”‚  [âœ¨ å¢å¼ºæç¤ºè¯]                      â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚              â”‚  â”‚
â”‚                                            â”‚  â”‚              â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚         å‚æ•°é…ç½®åŒºåŸŸ                   â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  æ¨¡å‹: [ä¸‹æ‹‰é€‰æ‹© â–¼]                   â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  æ¯”ä¾‹: [1:1] [16:9] [9:16] [4:3]     â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  å°ºå¯¸: W [====â—====] H [====â—====]   â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  æ•°é‡: [1] [2] [3] [4]               â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  [â–¼ é«˜çº§å‚æ•°]                         â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚              â”‚  â”‚
â”‚                                            â”‚  â”‚              â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚         ç»“æœå±•ç¤ºåŒºåŸŸ                   â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  â”‚                                â”‚  â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  â”‚         å›¾åƒé¢„è§ˆ               â”‚  â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  â”‚                                â”‚  â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â”‚  [ä¸‹è½½] [æ”¾å¤§] [å¤åˆ¶] [é‡æ–°ç”Ÿæˆ]       â”‚  â”‚  â”‚              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚  â”‚              â”‚  â”‚
â”‚                                            â”‚  â”‚              â”‚  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚  â”‚  [ğŸŒ ç”Ÿæˆå›¾åƒ]        é¢„è®¡æ¶ˆè€—: 0.02$ â”‚  â”‚                    â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚                    â”‚
â”‚                                            â”‚                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 5.2 å“åº”å¼è®¾è®¡

| æ–­ç‚¹ | å¸ƒå±€è°ƒæ•´ |
|------|----------|
| Desktop (â‰¥1200px) | å·¦ä¾§æ“ä½œåŒº + å³ä¾§å†å²æ  |
| Tablet (768-1199px) | å•æ å¸ƒå±€ï¼Œå†å²æ å¯æ”¶èµ· |
| Mobile (<768px) | å•æ å¸ƒå±€ï¼Œå†å²æ åº•éƒ¨æŠ½å±‰ |

### 5.3 ä¸»é¢˜é€‚é…

- æ”¯æŒäº®è‰²/æš—è‰²ä¸»é¢˜åˆ‡æ¢
- å¤ç”¨ç³»ç»Ÿç°æœ‰çš„ ThemeContext
- ç»„ä»¶ä½¿ç”¨ Semi Design å†…ç½®ä¸»é¢˜å˜é‡

---

## å…­ã€çŠ¶æ€ç®¡ç†è®¾è®¡

### 6.1 Context State å®šä¹‰

```javascript
const initialState = {
  // æç¤ºè¯
  prompt: '',
  negativePrompt: '',
  enhancedPrompt: '',

  // æ¨¡å‹
  selectedModel: '',              // ç”± API è¿”å›çš„å¯ç”¨æ¨¡å‹å†³å®š
  availableModels: [],
  modelsLoading: false,

  // å‚æ•°
  resolution: '1k',               // åˆ†è¾¨ç‡æ¡£ä½: '1k' | '2k' | '4k'
  aspectRatio: '1:1',             // å›¾åƒæ¯”ä¾‹
  width: 1024,                    // è®¡ç®—å¾—å‡ºçš„å®½åº¦
  height: 1024,                   // è®¡ç®—å¾—å‡ºçš„é«˜åº¦
  numberOfImages: 1,
  guidanceScale: 7.5,
  inferenceSteps: 50,
  seed: -1,

  // ç”ŸæˆçŠ¶æ€
  generationStatus: 'idle', // idle | loading | success | error
  generationProgress: 0,
  generationMessage: '',
  generationError: null,

  // ç»“æœ
  generatedImages: [],
  selectedImageIndex: 0,

  // å†å²
  historyRecords: [],
  historyLoading: false,

  // UI çŠ¶æ€
  showAdvancedParams: false,
  showHistorySidebar: true,
  showNegativePrompt: false,
};
```

### 6.2 Actions å®šä¹‰

```javascript
const ActionTypes = {
  // æç¤ºè¯
  SET_PROMPT: 'SET_PROMPT',
  SET_NEGATIVE_PROMPT: 'SET_NEGATIVE_PROMPT',
  SET_ENHANCED_PROMPT: 'SET_ENHANCED_PROMPT',

  // æ¨¡å‹
  SET_SELECTED_MODEL: 'SET_SELECTED_MODEL',
  SET_AVAILABLE_MODELS: 'SET_AVAILABLE_MODELS',
  SET_MODELS_LOADING: 'SET_MODELS_LOADING',

  // å‚æ•°
  SET_RESOLUTION: 'SET_RESOLUTION',
  SET_ASPECT_RATIO: 'SET_ASPECT_RATIO',
  SET_SIZE: 'SET_SIZE',
  SET_NUMBER_OF_IMAGES: 'SET_NUMBER_OF_IMAGES',
  SET_ADVANCED_PARAMS: 'SET_ADVANCED_PARAMS',

  // ç”Ÿæˆ
  START_GENERATION: 'START_GENERATION',
  UPDATE_GENERATION_PROGRESS: 'UPDATE_GENERATION_PROGRESS',
  GENERATION_SUCCESS: 'GENERATION_SUCCESS',
  GENERATION_ERROR: 'GENERATION_ERROR',
  RESET_GENERATION: 'RESET_GENERATION',

  // ç»“æœ
  SET_GENERATED_IMAGES: 'SET_GENERATED_IMAGES',
  SET_SELECTED_IMAGE_INDEX: 'SET_SELECTED_IMAGE_INDEX',

  // å†å²
  LOAD_HISTORY: 'LOAD_HISTORY',
  ADD_HISTORY_RECORD: 'ADD_HISTORY_RECORD',
  DELETE_HISTORY_RECORD: 'DELETE_HISTORY_RECORD',
  CLEAR_HISTORY: 'CLEAR_HISTORY',
  LOAD_FROM_HISTORY: 'LOAD_FROM_HISTORY',

  // UI
  TOGGLE_ADVANCED_PARAMS: 'TOGGLE_ADVANCED_PARAMS',
  TOGGLE_HISTORY_SIDEBAR: 'TOGGLE_HISTORY_SIDEBAR',
  TOGGLE_NEGATIVE_PROMPT: 'TOGGLE_NEGATIVE_PROMPT',
};
```

---

## ä¸ƒã€é”™è¯¯å¤„ç†è®¾è®¡

### 7.1 é”™è¯¯ç±»å‹

| é”™è¯¯ç  | é”™è¯¯ç±»å‹ | å¤„ç†æ–¹å¼ |
|--------|----------|----------|
| 400 | å‚æ•°é”™è¯¯ | æ˜¾ç¤ºå…·ä½“å‚æ•°é—®é¢˜ |
| 401 | æœªæˆæƒ | è·³è½¬ç™»å½•é¡µ |
| 402 | ä½™é¢ä¸è¶³ | æ˜¾ç¤ºå……å€¼å¼•å¯¼ |
| 429 | è¯·æ±‚è¿‡äºé¢‘ç¹ | æ˜¾ç¤ºå€’è®¡æ—¶ç­‰å¾… |
| 500 | æœåŠ¡å™¨é”™è¯¯ | æ˜¾ç¤ºé‡è¯•æŒ‰é’® |
| NETWORK | ç½‘ç»œé”™è¯¯ | æ£€æŸ¥ç½‘ç»œè¿æ¥ |
| TIMEOUT | è¯·æ±‚è¶…æ—¶ | æ˜¾ç¤ºé‡è¯•æŒ‰é’® |

### 7.2 é”™è¯¯æç¤ºç»„ä»¶

```jsx
<ErrorBanner
  type="warning"
  message="ä½™é¢ä¸è¶³ï¼Œè¯·å……å€¼åç»§ç»­ä½¿ç”¨"
  action={<Button onClick={goToTopup}>ç«‹å³å……å€¼</Button>}
  closable
/>
```

---

## å…«ã€æ€§èƒ½ä¼˜åŒ–ç­–ç•¥

### 8.1 å›¾åƒåŠ è½½ä¼˜åŒ–

- ä½¿ç”¨ç¼©ç•¥å›¾é¢„è§ˆï¼Œç‚¹å‡»ååŠ è½½åŸå›¾
- å›¾åƒæ‡’åŠ è½½ (Intersection Observer)
- å›¾åƒé¢„åŠ è½½ï¼ˆé¢„åŠ è½½ä¸‹ä¸€å¼ ï¼‰
- WebP æ ¼å¼ä¼˜å…ˆ

### 8.2 çŠ¶æ€ä¼˜åŒ–

- ä½¿ç”¨ useMemo ç¼“å­˜è®¡ç®—ç»“æœ
- ä½¿ç”¨ useCallback ç¼“å­˜å›è°ƒå‡½æ•°
- æŒ‰éœ€åŠ è½½å†å²è®°å½•ï¼ˆåˆ†é¡µåŠ è½½ï¼‰

### 8.3 è¯·æ±‚ä¼˜åŒ–

- è¯·æ±‚é˜²æŠ–ï¼ˆé¿å…é‡å¤æäº¤ï¼‰
- è¯·æ±‚å–æ¶ˆï¼ˆç»„ä»¶å¸è½½æ—¶å–æ¶ˆï¼‰
- è¯·æ±‚ç¼“å­˜ï¼ˆç›¸åŒå‚æ•°å¤ç”¨ç»“æœï¼‰

---

## ä¹ã€å›½é™…åŒ–è®¾è®¡

### 9.1 éœ€è¦ç¿»è¯‘çš„æ–‡æ¡ˆ

```json
{
  "bananaImage": {
    "title": "é¦™è•‰ç”Ÿå›¾",
    "prompt": {
      "placeholder": "æè¿°ä½ æƒ³è¦ç”Ÿæˆçš„å›¾åƒå†…å®¹...",
      "negative": "åå‘æç¤ºè¯",
      "negativePlaceholder": "æè¿°ä½ ä¸æƒ³åœ¨å›¾åƒä¸­å‡ºç°çš„å…ƒç´ ...",
      "enhance": "å¢å¼ºæç¤ºè¯",
      "enhancing": "ä¼˜åŒ–ä¸­..."
    },
    "model": {
      "label": "é€‰æ‹©æ¨¡å‹",
      "placeholder": "è¯·é€‰æ‹©å›¾åƒç”Ÿæˆæ¨¡å‹"
    },
    "params": {
      "aspectRatio": "å›¾åƒæ¯”ä¾‹",
      "size": "å°ºå¯¸",
      "width": "å®½åº¦",
      "height": "é«˜åº¦",
      "numberOfImages": "ç”Ÿæˆæ•°é‡",
      "advanced": "é«˜çº§å‚æ•°",
      "guidanceScale": "å¼•å¯¼ç³»æ•°",
      "inferenceSteps": "æ¨ç†æ­¥æ•°",
      "seed": "éšæœºç§å­",
      "seedRandom": "éšæœº"
    },
    "generate": {
      "button": "ç”Ÿæˆå›¾åƒ",
      "generating": "ç”Ÿæˆä¸­...",
      "cost": "é¢„è®¡æ¶ˆè€—",
      "balance": "å½“å‰ä½™é¢"
    },
    "result": {
      "download": "ä¸‹è½½",
      "zoom": "æ”¾å¤§",
      "copy": "å¤åˆ¶æç¤ºè¯",
      "regenerate": "é‡æ–°ç”Ÿæˆ",
      "empty": "æš‚æ— ç”Ÿæˆç»“æœ",
      "emptyHint": "è¾“å…¥æç¤ºè¯å¹¶ç‚¹å‡»ç”ŸæˆæŒ‰é’®å¼€å§‹åˆ›ä½œ"
    },
    "history": {
      "title": "å†å²è®°å½•",
      "empty": "æš‚æ— å†å²è®°å½•",
      "clear": "æ¸…ç©ºå†å²",
      "clearConfirm": "ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†å²è®°å½•å—ï¼Ÿ",
      "delete": "åˆ é™¤",
      "load": "åŠ è½½å‚æ•°"
    },
    "error": {
      "insufficientBalance": "ä½™é¢ä¸è¶³ï¼Œè¯·å……å€¼åç»§ç»­ä½¿ç”¨",
      "networkError": "ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œ",
      "serverError": "æœåŠ¡å™¨é”™è¯¯ï¼Œè¯·ç¨åé‡è¯•",
      "invalidPrompt": "è¯·è¾“å…¥æœ‰æ•ˆçš„æç¤ºè¯"
    }
  }
}
```

---

## åã€å¼€å‘è®¡åˆ’

### 10.1 é˜¶æ®µåˆ’åˆ†

| é˜¶æ®µ | å†…å®¹ | é¢„è®¡å·¥ä½œé‡ |
|------|------|------------|
| Phase 1 | åŸºç¡€æ¡†æ¶æ­å»º | - |
| Phase 2 | æ ¸å¿ƒåŠŸèƒ½å®ç° | - |
| Phase 3 | é«˜çº§åŠŸèƒ½å®Œå–„ | - |
| Phase 4 | ä¼˜åŒ–ä¸æµ‹è¯• | - |

### 10.2 Phase 1: åŸºç¡€æ¡†æ¶æ­å»º

- [x] éœ€æ±‚åˆ†æå’ŒæŠ€æœ¯è§„åˆ’
- [ ] åˆ›å»ºé¡µé¢ç›®å½•ç»“æ„
- [ ] é…ç½®è·¯ç”±
- [ ] åˆ›å»º Context å’ŒåŸºç¡€ Hooks
- [ ] å®ç°é¡µé¢åŸºç¡€å¸ƒå±€

### 10.3 Phase 2: æ ¸å¿ƒåŠŸèƒ½å®ç°

- [ ] æç¤ºè¯è¾“å…¥ç»„ä»¶
- [ ] æ¨¡å‹é€‰æ‹©ç»„ä»¶
- [ ] å‚æ•°é…ç½®é¢æ¿
- [ ] å›¾åƒç”Ÿæˆ API è°ƒç”¨
- [ ] ç»“æœå±•ç¤ºç»„ä»¶

### 10.4 Phase 3: é«˜çº§åŠŸèƒ½å®Œå–„

- [ ] å†å²è®°å½•åŠŸèƒ½
- [ ] æç¤ºè¯å¢å¼ºåŠŸèƒ½
- [ ] è´¹ç”¨é¢„ä¼°æ˜¾ç¤º
- [ ] å¿«æ·é”®æ”¯æŒ

### 10.5 Phase 4: ä¼˜åŒ–ä¸æµ‹è¯•

- [ ] å“åº”å¼é€‚é…
- [ ] æ€§èƒ½ä¼˜åŒ–
- [ ] é”™è¯¯å¤„ç†å®Œå–„
- [ ] å›½é™…åŒ–æ”¯æŒ
- [ ] æµ‹è¯•ä¸ Bug ä¿®å¤

---

## åä¸€ã€é™„å½•

### 11.1 è®¾è®¡å‚è€ƒ

- UI è®¾è®¡ç¨¿ï¼š`/web/img.png`
- ç°æœ‰ Playground é¡µé¢ï¼š`/src/pages/Playground/`
- ç°æœ‰ Midjourney é¡µé¢ï¼š`/src/pages/Midjourney/`

### 11.2 ç›¸å…³æ–‡æ¡£

- [OpenAI Images API](https://platform.openai.com/docs/api-reference/images)
- [Semi Design ç»„ä»¶åº“](https://semi.design/)
- [Tailwind CSS](https://tailwindcss.com/)

### 11.3 ä¿®è®¢è®°å½•

| ç‰ˆæœ¬ | æ—¥æœŸ | ä¿®è®¢å†…å®¹ | ä½œè€… |
|------|------|----------|------|
| 1.0 | 2026-02-05 | åˆå§‹ç‰ˆæœ¬ | - |
